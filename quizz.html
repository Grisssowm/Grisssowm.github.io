<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Interativo — História (50 questões)</title>
  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --primary:#2563eb;
      --success:#16a34a;
      --danger:#dc2626;
      --muted:#6b7280;
    }
    body{
      margin:0;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      padding:24px;
    }
    .container{
      width:100%;
      max-width:920px;
      background:var(--card);
      border-radius:16px;
      box-shadow:0 8px 30px rgba(12,15,20,0.08);
      padding:28px;
      box-sizing:border-box;
    }
    header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:18px;
    }
    h1{ margin:0; font-size:20px; }
    .meta{ color:var(--muted); font-size:13px; }
    .progress-wrap{ width:100%; background:#e6eefc; height:12px; border-radius:999px; overflow:hidden; margin:12px 0 18px; }
    .progress{ height:100%; width:0%; background:linear-gradient(90deg,var(--primary),#60a5fa); transition:width .35s ease; }
    .progress-text{ text-align:right; font-size:12px; color:var(--muted); margin-bottom:6px; }
    .card{
      padding:18px;
      border-radius:12px;
      background:linear-gradient(180deg, rgba(255,255,255,0.98), rgba(250,250,252,0.98));
      box-shadow:inset 0 1px 0 rgba(255,255,255,0.6);
    }
    .question-number{ color:var(--muted); font-size:13px; margin-bottom:8px; }
    .question{ font-size:18px; margin:0 0 14px 0; }
    .choices{ display:flex; flex-direction:column; gap:10px; align-items:center; }
    .choice-btn{
      width:100%;
      max-width:740px;
      padding:12px 14px;
      border-radius:10px;
      border:1px solid #e6e9ef;
      background:#fff;
      cursor:pointer;
      text-align:center;
      font-size:16px;
      box-shadow:0 2px 6px rgba(12,15,20,0.04);
      transition:transform .06s ease, box-shadow .06s ease;
    }
    .choice-btn:active{ transform:translateY(1px); }
    .choice-btn[disabled]{ cursor:default; opacity:0.95; }
    .choice-correct{ background:rgba(22,163,74,0.12); border-color: rgba(22,163,74,0.22); }
    .choice-wrong{ background:rgba(220,38,38,0.08); border-color: rgba(220,38,38,0.18); }
    .next-wrap{ display:flex; justify-content:center; margin-top:16px; }
    .next-btn{
      display:inline-block;
      padding:10px 18px;
      border-radius:10px;
      background:var(--primary);
      color:white;
      border:none;
      cursor:pointer;
      font-weight:600;
      font-size:15px;
      box-shadow:0 6px 18px rgba(37,99,235,0.18);
      visibility:hidden;
      opacity:0;
      transform:translateY(6px);
      transition:all .18s ease;
    }
    .next-btn.show{ visibility:visible; opacity:1; transform:translateY(0); }
    .summary{
      margin-top:20px;
    }
    .summary h2{ margin:10px 0 6px 0; font-size:18px; }
    .summary-list{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:10px; }
    .summary-item{ background:#fbfdff; padding:10px 12px; border-radius:10px; border:1px solid #eef6ff; }
    .score{ font-weight:700; font-size:18px; margin-top:10px; }
    .explain{ color:var(--muted); font-size:14px; margin-top:6px; }
    footer{ margin-top:18px; color:var(--muted); font-size:13px; display:flex; justify-content:space-between; align-items:center; }
    .small{ font-size:12px; color:var(--muted); }
    /* responsive */
    @media (max-width:720px){
      .choice-btn{ font-size:15px; padding:10px 12px; }
    }
  </style>
</head>
<body>
  <div class="container" role="main">
    <header>
      <div>
        <h1>Quiz Interativo — História: Vinda da Corte & Independência (50)</h1>
        <div class="meta">Fonte: Documento sem título - Documentos Google. Perguntas extraídas e adaptadas do documento. :contentReference[oaicite:1]{index=1}</div>
      </div>
      <div style="text-align:right">
        <div class="small">Progresso</div>
        <div class="progress-wrap" aria-hidden="true">
          <div class="progress" id="progress"></div>
        </div>
        <div class="progress-text" id="progressText">0% concluído</div>
      </div>
    </header>

    <section class="card" id="quizCard">
      <div class="question-number" id="qNumber">Questão 1 de 50</div>
      <h2 class="question" id="questionText">Carregando...</h2>

      <div class="choices" id="choices"></div>

      <div class="next-wrap">
        <button id="nextBtn" class="next-btn">Próxima</button>
      </div>

    </section>

    <section class="summary" id="summarySection" style="display:none;">
      <h2>Resumo final</h2>
      <div class="score" id="scoreText"></div>
      <ul class="summary-list" id="summaryList"></ul>
    </section>

    <footer>
      <div class="small">Estilo: fundo claro, contêiner branco, bordas arredondadas. Botões centralizados.</div>
      <div class="small">Resultado: ✔ acerto, ✖ erro. Explicação abaixo de cada pergunta.</div>
    </footer>
  </div>

  <script>
    // === QUESTÕES EXTRAÍDAS DO DOCUMENTO (50 questões) ===
    // Cada entrada: {type: 'mc'|'tf', q: 'Pergunta', choices: [...], correct: index, explanation: '...' }
    // Observação: alternativas serão embaralhadas dinamicamente.
    const questions = [
      { type:'mc', q:'Qual foi a causa imediata que levou a família real portuguesa a fugir para o Brasil?', 
        choices:['Invasão napoleônica na Península Ibérica','Revolução Liberal do Porto','Gripe na corte','Seca prolongada em Portugal'],
        correct:0,
        explanation:'Com o avanço das tropas de Napoleão na Península Ibérica a família real fugiu para o Brasil.'},

      { type:'mc', q:'O bloqueio continental foi descumprido por qual país, segundo o documento?', 
        choices:['Inglaterra','Espanha','França','Holanda'],
        correct:0,
        explanation:'O texto menciona o descumprimento do bloqueio continental da Inglaterra.'},

      { type:'mc', q:'A viagem da corte para o Brasil teve duração aproximada de:', 
        choices:['Meses e levou mais de 10 mil pessoas','Algumas semanas e 500 pessoas','Dois anos e 50 mil pessoas','Uma semana e 2 mil pessoas'],
        correct:0,
        explanation:'O documento diz que a viagem teve duração de meses e levou mais de 10 mil pessoas.'},

      { type:'mc', q:'Uma mudança importante na economia mencionada foi:', 
        choices:['Abertura dos portos aos países exportadores','Fechamento do Banco do Brasil','Proibição de comércio com a Inglaterra','Nacionalização das terras'],
        correct:0,
        explanation:'Com a chegada da corte foram abertos os portos, fim do pacto colonial.'},

      { type:'mc', q:'A abertura dos portos resultou em:', 
        choices:['Quebra do pacto colonial e mais autonomia à colônia','Retorno imediato da família real a Portugal','Fim do comércio com a Inglaterra','Fim do escravismo'],
        correct:0,
        explanation:'O texto descreve a quebra do pacto colonial e aumento de autonomia com a abertura dos portos.'},

      { type:'mc', q:'Qual instituição NÃO foi citada como criada após a chegada da corte?', 
        choices:['Banco do Brasil','Real Biblioteca','Universidade Federal do Rio de Janeiro','Nenhuma das anteriores'],
        correct:2,
        explanation:'O documento cita Banco do Brasil e a Real Biblioteca; não cita a UFRJ.'},

      { type:'tf', q:'Verdadeiro ou falso: A chegada da corte deixou a colônia totalmente livre de dependência econômica.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o documento relata que tratados tornaram o Brasil dependente de produtos ingleses.'},

      { type:'mc', q:'Os tratados e acordos assinados com a Inglaterra causaram:', 
        choices:['Descontentamento por depender de produtos ingleses','Aumento da independência econômica','Fim das elites agrárias','Imediata abolição da escravidão'],
        correct:0,
        explanation:'Os tratados aumentaram dependência de produtos ingleses e desagradaram colonos e artesãos.'},

      { type:'mc', q:'Que característica social foi mantida após a chegada da corte?', 
        choices:['Patriarcalismo','Igualdade de gênero','Redistribuição de terras','Fim do escravismo'],
        correct:0,
        explanation:'O documento cita o patriarcalismo como característica mantida.'},

      { type:'mc', q:'O que significa "elite fundiária" conforme o texto?', 
        choices:['Poucas pessoas com muitas terras','Distribuição igual de terras','Propriedade coletiva','Pequenos proprietários rurais'],
        correct:0,
        explanation:'Elite fundiária refere-se a muitas terras concentradas em poucas mãos.'},

      { type:'mc', q:'Segundo o documento, qual foi a “solução” encontrada para a mão de obra após o genocídio indígena?', 
        choices:['Escravização de africanos','Imigração europeia em massa','Mecanização agrícola','Trabalho assalariado urbano'],
        correct:0,
        explanation:'O texto afirma que a escravização de africanos foi utilizada para a produção.'},

      { type:'mc', q:'A Missão Artística Francesa foi enviada por qual país?', 
        choices:['França','Inglaterra','Espanha','Itália'],
        correct:0,
        explanation:'Tratou-se de uma missão artística francesa comandada por Joachim Lebreton.'},

      { type:'mc', q:'Quem comandou a Missão Artística Francesa mencionada no documento?', 
        choices:['Joachim Lebreton','Napoleão Bonaparte','Dom João VI','José Bonifácio'],
        correct:0,
        explanation:'O documento menciona Joachim Lebreton como comandante da missão.'},

      { type:'mc', q:'A Missão Francesa introduziu qual estilo à arte americana?', 
        choices:['Neoclássico','Barroco','Romântico','Gótico'],
        correct:0,
        explanation:'A missão incorporou o modelo neoclássico à arte americana.'},

      { type:'mc', q:'A Revolução Pernambucana foi inspirada por ideias de:', 
        choices:['Iluminismo e revoluções americanas','Monarquismo absoluto','Absolutismo francês','Modelo colonial espanhol'],
        correct:0,
        explanation:'O texto diz que a Revolução Pernambucana se inspirou em ideias iluministas e em outras revoluções.'},

      { type:'tf', q:'Verdadeiro ou falso: A Revolução Pernambucana resultou permanentemente na independência do estado.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — Dom João enviou tropas portuguesas para restaurar a ordem.'},

      { type:'mc', q:'A Revolução Liberal do Porto levou a exigir que:', 
        choices:['Dom João retornasse a Portugal e tivesse seus poderes reduzidos por uma Constituição','Dom João permanecesse no Brasil com poderes ilimitados','Portugal se tornasse colônia do Brasil','A França ocupasse Portugal'],
        correct:0,
        explanation:'O movimento exigiu o retorno de Dom João e limitação de poderes por Constituição.'},

      { type:'mc', q:'Quem ficou como príncipe regente quando Dom João voltou a Portugal?', 
        choices:['Dom Pedro I','José Bonifácio','Joachim Lebreton','Napoleão'],
        correct:0,
        explanation:'Dom Pedro I ficou como príncipe regente conforme o texto.'},

      { type:'tf', q:'Verdadeiro ou falso: O "Dia do Fico" foi quando Dom Pedro decidiu voltar para Portugal.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o "Dia do Fico" é quando Dom Pedro decidiu ficar no Brasil.'},

      { type:'mc', q:'O documento relaciona o "Dia do Fico" com:', 
        choices:['A decisão de Dom Pedro de permanecer no Brasil e se aproximar do povo','A volta imediata de Dom Pedro para Portugal','A assinatura da Constituição portuguesa','A abolição da escravatura'],
        correct:0,
        explanation:'O "Dia do Fico" marcou a permanência de Dom Pedro e sua aproximação a figuras como José Bonifácio.'},

      { type:'mc', q:'Quem foi citado como aliado de Dom Pedro no processo que levou à independência?', 
        choices:['José Bonifácio','Joachim Lebreton','Napoleão Bonaparte','O rei da Inglaterra'],
        correct:0,
        explanation:'O documento cita José Bonifácio como uma figura importante aliada de Dom Pedro.'},

      { type:'mc', q:'O Grito da Independência está relacionado a qual período do documento?', 
        choices:['Emancipação da colônia e independência','Missão artística francesa','Criação do Banco do Brasil','Revolução Pernambucana apenas'],
        correct:0,
        explanation:'O Grito da Independência faz parte do capítulo sobre emancipação da colônia e independência.'},

      { type:'mc', q:'Segundo o documento, a corte no Brasil fez transformações para tornar o Rio de Janeiro:', 
        choices:['Digno de ser a nova sede da monarquia portuguesa','Menos atraente para estrangeiros','Uma capital republicana imediata','Uma cidade sem portos'],
        correct:0,
        explanation:'Com a chegada da corte, medidas foram tomadas para que o Rio fosse sede da monarquia.'},

      { type:'mc', q:'Os tratados mencionados no documento datam de qual ano (conforme escrito no arquivo)?', 
        choices:['1910 (conforme texto)','1810','1822','1808'],
        correct:0,
        explanation:'O documento menciona "tratados de 1910" — possivelmente uma referência textual no arquivo.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento afirma que os tratados com a Inglaterra agradaram a todos na colônia.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — esses tratados desagradaram a colônia por aumentar dependência de produtos ingleses.'},

      { type:'mc', q:'A paisagem americana chamou a atenção de quem, segundo o texto?', 
        choices:['Artistas e pesquisadores franceses','Somente artistas portugueses','Somente viajantes brasileiros','Soldados ingleses'],
        correct:0,
        explanation:'A paisagem chamou atenção de artistas e pesquisadores, motivo da missão francesa.'},

      { type:'mc', q:'A missão artística francesa incorporou qual elemento à arte local?', 
        choices:['Modelo neoclássico','Arte barroca','Expressionismo','Impressionismo'],
        correct:0,
        explanation:'O texto menciona que foi incorporado o modelo neoclássico.'},

      { type:'mc', q:'O que o documento indica sobre a estrutura social após chegada da corte?', 
        choices:['Manutenção de desigualdades, patriarcalismo e elite fundiária','Rápida igualdade de direitos','Fim da escravidão','Redução das terras concentradas'],
        correct:0,
        explanation:'O documento fala em manutenção de patriarcalismo, elite fundiária e escravismo.'},

      { type:'mc', q:'A expressão "elite fundiária" está ligada a:', 
        choices:['Importância da terra para produção agrícola e lucro','Indústria urbana forte','Educação universal','Agricultura coletiva'],
        correct:0,
        explanation:'A terra era central para produção agrícola e lucro, sendo concentrada em poucas mãos.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento descreve que a escravidão foi substituída imediatamente por trabalho assalariado.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o documento explica que a escravização de africanos foi utilizada após o genocídio indígena.'},

      { type:'mc', q:'Qual impacto cultural a presença da corte trouxe, segundo o texto?', 
        choices:['Atração de missões científicas e artísticas','Fechamento de instituições culturais','Expulsão de pesquisadores','Proibição de arte estrangeira'],
        correct:0,
        explanation:'A presença da corte atraiu artistas e pesquisadores, incluindo a missão francesa.'},

      { type:'mc', q:'Qual foi um dos objetivos da missão artística francesa?', 
        choices:['Documentar e incorporar modelos artísticos europeus','Converter o Brasil em província francesa','Impor a língua francesa como oficial','Fechar bibliotecas brasileiras'],
        correct:0,
        explanation:'A missão buscou estudar a colônia e incorporar o modelo neoclássico.'},

      { type:'mc', q:'A queixa dos artesãos e comerciantes citada no texto estava relacionada a:', 
        choices:['Dependência do comércio de produtos ingleses','Aumento de impostos internos','Invasão direta por França','Proibição de manufaturas locais'],
        correct:0,
        explanation:'Os tratados fizeram o comércio local depender de produtos ingleses, prejudicando artesãos e comerciantes.'},

      { type:'mc', q:'O que o documento sugere sobre os tratados assinados (ex.: Tratado de Aliança e Amizade)?', 
        choices:['Tornaram o Brasil dependente da Inglaterra','Garantiram completa autonomia industrial','Aboliram o pacto colonial sem efeitos','Foram completamente rejeitados pela corte'],
        correct:0,
        explanation:'O documento afirma que os tratados tornaram o Brasil dependente de produtos ingleses.'},

      { type:'tf', q:'Verdadeiro ou falso: Segundo o texto, a corte trouxe imediata igualdade entre homem e mulher.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o patriarcalismo foi mantido.'},

      { type:'mc', q:'Qual foi uma consequência política da permanência da corte no Brasil para Portugal?', 
        choices:['Portugal exigiu o retorno de Dom João e redução de poderes','Portugal tornou-se independente do Brasil','Portugal adotou a monarquia brasileira','Portugal foi absorvido pela França'],
        correct:0,
        explanation:'A Revolução Liberal do Porto exigiu que Dom João voltasse e tivesse poderes reduzidos.'},

      { type:'mc', q:'O documento associa o aumento da autonomia local a qual medida da corte?', 
        choices:['Abertura dos portos','Fechamento das fronteiras','Repressão cultural','Redistribuição de terras'],
        correct:0,
        explanation:'A abertura dos portos é mencionada como causa de maior autonomia.'},

      { type:'mc', q:'A quem o texto atribui parte do processo de independência do Brasil (liderança local)?', 
        choices:['Dom Pedro e aliados como José Bonifácio','Somente Napoleão','Somente a França','A Inglaterra diretamente'],
        correct:0,
        explanation:'O documento cita Dom Pedro e José Bonifácio entre os protagonistas.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento descreve que a Revolução Pernambucana imediatamente criou uma república permanente.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — a revolução proclamou uma república, mas tropas portuguesas restabeleceram o controle.'},

      { type:'mc', q:'Que fator do mundo externo influenciou as revoltas citadas no documento?', 
        choices:['Exemplos das Treze Colônias e ideias iluministas','Guerras no Pacífico','Industrialização japonesa','Colonização africana'],
        correct:0,
        explanation:'O texto aponta influência das revoluções americanas e do iluminismo.'},

      { type:'mc', q:'Qual cidade foi preparada para ser sede da monarquia?', 
        choices:['Rio de Janeiro','São Paulo','Salvador','Recife'],
        correct:0,
        explanation:'O Rio de Janeiro foi preparado para ser a nova sede da monarquia portuguesa.'},

      { type:'mc', q:'Qual das seguintes foi uma transformação administrativa citada?', 
        choices:['Criação de instituições como o Banco do Brasil','Abolição do Senado','Criação de uma república imediata','Fechamento de portos'],
        correct:0,
        explanation:'O documento cita criação do Banco do Brasil e da Real Biblioteca, entre outras instituições.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento menciona que a missão francesa teve papel científico e artístico.', 
        choices:['Verdadeiro','Falso'], correct:0,
        explanation:'Verdadeiro — ela trouxe artistas e pesquisadores para estudar a colônia.'},

      { type:'mc', q:'Qual modelo artístico a missão francesa introduziu principalmente?', 
        choices:['Neoclassicismo','Barroco','Cubismo','Expressionismo'],
        correct:0,
        explanation:'O modelo neoclássico foi incorporado à arte local pela missão.'},

      { type:'mc', q:'No contexto do documento, o que foi o “pacto colonial”?', 
        choices:['Sistema que vinculava o comércio colonial a Portugal','Uma aliança militar','Uma instituição educacional','Um tratado com a França'],
        correct:0,
        explanation:'O pacto colonial vinculava o comércio colonial à metrópole; sua quebra veio com a abertura dos portos.'},

      { type:'mc', q:'O documento indica que a dependência de produtos ingleses afetou principalmente:', 
        choices:['Artesãos, comerciantes e a economia local','Exclusivamente a coroa portuguesa','Somente os proprietários de terras','A Igreja Católica'],
        correct:0,
        explanation:'Artesãos e comerciantes sentiram-se prejudicados pela dependência de produtos ingleses.'},

      { type:'tf', q:'Verdadeiro ou falso: O texto afirma que a chegada da corte levou à imediata igualdade social.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o texto fala em manutenção de desigualdades como elite fundiária e patriarcalismo.'},

      { type:'mc', q:'Qual foi um motivo para enviar a missão francesa ao Brasil, segundo o documento?', 
        choices:['Interesse artístico e científico pela paisagem americana','Expansão territorial','Forçar a independência','Impor o idioma francês'],
        correct:0,
        explanation:'Houve interesse artístico e científico pela paisagem americana.'},

      { type:'mc', q:'De acordo com o documento, a aproximação de Dom Pedro com o povo ocorreu após:', 
        choices:['O Dia do Fico, quando ele optou por ficar','Sua viagem de volta a Portugal','A missão francesa','A assinatura da Constituição portuguesa'],
        correct:0,
        explanation:'O "Dia do Fico" marca a decisão de Dom Pedro de permanecer no Brasil e se aproximar do povo.'},

      { type:'mc', q:'A quem o texto atribui parte da causa das revoltas e insatisfações?', 
        choices:['Privilegios de membros da corte e dependências econômicas','Clima tropical','Ataques indígenas','Crises de alimentação apenas'],
        correct:0,
        explanation:'O descontentamento vinha por privilégios de membros da corte e medidas econômicas.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento afirma que a missão francesa trouxe escultores que construíram monumentos dos ingleses.', 
        choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — o documento não menciona monumentos ingleses; fala em missão artística e neoclassicismo.'},

      { type:'mc', q:'Qual foi uma consequência cultural positiva citada pela presença de artistas e pesquisadores?', 
        choices:['Incorporação de novos estilos artísticos e estudo da paisagem','Esquecimento da arte local','Proibição da pintura','Nenhuma mudança cultural'],
        correct:0,
        explanation:'A missão levou incorporação do neoclassicismo e atenção à paisagem americana.'}
    ];

    // --- helper: duplicate logic to reach exactly 50 questions ---
    // The source text provided roughly 40+ clear facts; to reach 50, we'll add variations and reinforce key points while staying faithful.
    // We'll create some additional T/F and MC variations based on the same document facts.
    const extraQuestions = [
      { type:'tf', q:'Verdadeiro ou falso: O documento diz que a Inglaterra governou provisoriamente Portugal após a fuga da corte.', choices:['Verdadeiro','Falso'], correct:0,
        explanation:'O texto menciona que, com a corte no Brasil, Portugal ficou sem membros da família real e a Inglaterra governou provisoriamente, o que desagradou os portugueses.'},

      { type:'mc', q:'O documento relaciona a vinda da corte ao Brasil com qual acontecimento europeu?', choices:['Domínio de Napoleão Bonaparte','Revolução Industrial na Inglaterra','Unificação da Alemanha','Descobrimento da América'], correct:0,
        explanation:'A fuga da corte se deu com o domínio napoleônico na Península Ibérica.'},

      { type:'mc', q:'Segundo o texto, a viagem da corte contou com aproximadamente quantas pessoas?', choices:['Mais de 10 mil','Cerca de 100','Aproximadamente 500','Cerca de 1.000.000'], correct:0,
        explanation:'O documento registra mais de 10 mil pessoas na viagem.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento afirma que o Banco do Brasil foi criado após a chegada da corte.', choices:['Verdadeiro','Falso'], correct:0,
        explanation:'Verdadeiro — o texto cita a criação do Banco do Brasil como uma das instituições.'},

      { type:'mc', q:'A manutenção do patriarcalismo significa:', choices:['Homem no poder e mulher nas tarefas domésticas','Sociedade igualitária de gênero','Matriarcado predominante','Governo democrático imediato'], correct:0,
        explanation:'Patriarcalismo é descrito como homem no poder e mulher nas tarefas domésticas.'},

      { type:'mc', q:'O documento diz que a abertura dos portos beneficiou principalmente:', choices:['Países exportadores e deu mais autonomia à colônia','Somente a metrópole','Somente produtores africanos','Somente a Inglaterra'],
        correct:0, explanation:'A abertura dos portos foi aos países exportadores e quebrou o pacto colonial.'},

      { type:'tf', q:'Verdadeiro ou falso: Os tratados tornaram o Brasil independente da Inglaterra.', choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — os tratados tornaram o Brasil dependente de produtos ingleses.'},

      { type:'mc', q:'A reação contra a dependência aos ingleses atingiu principalmente:', choices:['Artesãos e comerciantes locais','A família real exclusivamente','Os pesquisadores franceses','Os navios portugueses'], correct:0,
        explanation:'Artesãos e comerciantes foram prejudicados pela dependência de produtos ingleses.'},

      { type:'mc', q:'Um dos impactos sociais citados foi:', choices:['Desigualdade baseada na concentração de terras','Ampla reforma agrária imediata','Propriedade comunal','Fim das elites'], correct:0,
        explanation:'O documento descreve a elite fundiária e desigualdades pela concentração da terra.'},

      { type:'tf', q:'Verdadeiro ou falso: O documento apresenta a Missão Francesa como elemento que afastou a estética europeia do Brasil.', choices:['Verdadeiro','Falso'], correct:1,
        explanation:'Falso — a missão incorporou modelos europeus (neoclássicos) ao espaço americano.'}
    ];

    // Merge arrays and ensure we have exactly 50
    while (questions.length + extraQuestions.length < 50){
      // if somehow short, duplicate some questions with small rephrasing
      extraQuestions.push(...extraQuestions.slice(0,1));
    }
    const allQuestions = questions.concat(extraQuestions).slice(0,50);

    // --- Utility functions ---
    function shuffleArray(arr){
      for(let i=arr.length-1;i>0;i--){
        const j=Math.floor(Math.random()*(i+1));
        [arr[i],arr[j]]=[arr[j],arr[i]];
      }
      return arr;
    }

    // Prepare quiz state
    let current = 0;
    const userAnswers = new Array(allQuestions.length).fill(null);
    const summaryData = [];

    const qNumberEl = document.getElementById('qNumber');
    const questionTextEl = document.getElementById('questionText');
    const choicesEl = document.getElementById('choices');
    const nextBtn = document.getElementById('nextBtn');
    const progressEl = document.getElementById('progress');
    const progressText = document.getElementById('progressText');
    const summarySection = document.getElementById('summarySection');
    const summaryList = document.getElementById('summaryList');
    const scoreText = document.getElementById('scoreText');

    // For each question, we'll keep a shuffled version of choices with mapping to original correct index
    const prepared = allQuestions.map(q=>{
      if(q.type==='mc' || q.type==='tf'){
        const items = q.choices.map((c,i)=>({text:c, originalIndex:i}));
        const shuffled = shuffleArray(items.slice());
        const correctOriginalIndex = q.correct;
        // find where original correct ended up
        const correctShuffledIndex = shuffled.findIndex(it=>it.originalIndex===correctOriginalIndex);
        return {
          ...q,
          shuffledChoices: shuffled.map(s=>s.text),
          correctShuffledIndex
        };
      } else return q;
    });

    function renderQuestion(index){
      const q = prepared[index];
      qNumberEl.textContent = `Questão ${index+1} de ${prepared.length}`;
      questionTextEl.textContent = q.q;
      choicesEl.innerHTML = '';
      nextBtn.classList.remove('show');
      nextBtn.style.visibility = 'hidden';

      // create choice buttons
      q.shuffledChoices.forEach((choiceText, i)=>{
        const btn = document.createElement('button');
        btn.className = 'choice-btn';
        btn.type = 'button';
        btn.innerText = choiceText;
        btn.dataset.index = i;
        btn.onclick = () => handleChoiceClick(btn, i);
        choicesEl.appendChild(btn);
      });

      // update progress
      const pct = Math.round((index / prepared.length) * 100);
      progressEl.style.width = pct + '%';
      progressText.textContent = pct + '% concluído';
    }

    function handleChoiceClick(btn, chosenIndex){
      const q = prepared[current];

      // prevent double clicks if already answered
      if(userAnswers[current] !== null) return;

      // mark user's answer
      userAnswers[current] = chosenIndex;

      // disable all buttons
      const buttons = Array.from(choicesEl.querySelectorAll('button.choice-btn'));
      buttons.forEach(b=>b.disabled = true);

      // visual feedback
      const correctIndex = q.correctShuffledIndex;
      buttons.forEach((b, idx)=>{
        if(idx === correctIndex){
          b.classList.add('choice-correct');
        }
        if(idx === chosenIndex && idx !== correctIndex){
          b.classList.add('choice-wrong');
        }
      });

      // show Next button
      nextBtn.style.visibility = 'visible';
      nextBtn.classList.add('show');

      // store summary data for later
      const wasCorrect = (chosenIndex === correctIndex);
      summaryData[current] = {
        question: q.q,
        chosenText: q.shuffledChoices[chosenIndex],
        correctText: q.shuffledChoices[correctIndex],
        correct: wasCorrect,
        explanation: q.explanation
      };
    }

    nextBtn.addEventListener('click', ()=>{
      // if last question, show summary
      if(current === prepared.length - 1){
        showSummary();
        return;
      }
      current++;
      renderQuestion(current);
    });

    function showSummary(){
      // progress 100%
      progressEl.style.width = '100%';
      progressText.textContent = '100% concluído';
      // hide quiz card
      document.getElementById('quizCard').style.display = 'none';
      summarySection.style.display = 'block';

      // compute score
      const correctCount = summaryData.filter(s=>s && s.correct).length;
      scoreText.textContent = `Pontuação: ${correctCount} / ${prepared.length}`;

      // list each question
      summaryList.innerHTML = '';
      prepared.forEach((q, i)=>{
        const data = summaryData[i] || {
          question: q.q,
          chosenText: 'Sem resposta',
          correctText: q.shuffledChoices[q.correctShuffledIndex],
          correct: false,
          explanation: q.explanation
        };
        const li = document.createElement('li');
        li.className = 'summary-item';
        const mark = data.correct ? '✔' : '✖';
        li.innerHTML = `<div style="display:flex;justify-content:space-between;align-items:center;gap:12px;">
            <div style="font-weight:600;">${i+1}. ${escapeHtml(data.question)}</div>
            <div style="font-size:20px;">${data.correct ? '<span style="color:var(--success)">'+mark+'</span>' : '<span style="color:var(--danger)">'+mark+'</span>'}</div>
          </div>
          <div style="margin-top:8px">
            <div><strong>Sua resposta:</strong> ${escapeHtml(data.chosenText)}</div>
            <div><strong>Resposta correta:</strong> ${escapeHtml(data.correctText)}</div>
            <div class="explain"><strong>Explicação:</strong> ${escapeHtml(data.explanation)}</div>
          </div>`;
        summaryList.appendChild(li);
      });

      // scroll to summary
      summarySection.scrollIntoView({behavior:'smooth'});
    }

    // simple escape to avoid injection when showing text
    function escapeHtml(text){
      return String(text).replace(/[&<>"'`=\/]/g, function (s) {
        return ({
          '&': '&amp;',
          '<': '&lt;',
          '>': '&gt;',
          '"': '&quot;',
          "'": '&#39;',
          '/': '&#x2F;',
          '`': '&#x60;',
          '=': '&#x3D;'
        })[s];
      });
    }

    // initialize first question
    renderQuestion(0);

    // Allow keyboard navigation: numbers 1-4 select, Enter next (if Next visible)
    document.addEventListener('keydown', (e)=>{
      const buttons = Array.from(choicesEl.querySelectorAll('button.choice-btn'));
      if(e.key >= '1' && e.key <= String(Math.min(9, buttons.length))){
        const idx = Number(e.key) - 1;
        if(buttons[idx] && !buttons[idx].disabled) buttons[idx].click();
      } else if(e.key === 'Enter'){
        if(nextBtn.classList.contains('show')) nextBtn.click();
      }
    });

  </script>
</body>
</html>
